// è¡¨ç™½ç½‘ç«™äº¤äº’åŠŸèƒ½
document.addEventListener('DOMContentLoaded', function() {
    // åˆ›å»ºæ›´å¤šé£˜åŠ¨çš„å¿ƒå½¢
    createFloatingHearts();
    
    // æ·»åŠ ç‚¹å‡»æ•ˆæœ
    addClickEffects();
    
    // æ·»åŠ é”®ç›˜äº¤äº’
    addKeyboardInteractions();
});

function showSurprise() {
    const surprise = document.getElementById('surprise');
    const button = document.querySelector('.love-button');
    
    if (surprise.classList.contains('hidden')) {
        surprise.classList.remove('hidden');
        button.textContent = 'å†æ¬¡ç‚¹å‡» ğŸ’•';
        
        // åˆ›å»ºçˆ†ç‚¸æ•ˆæœ
        createExplosion();
        
        // æ’­æ”¾éŸ³æ•ˆï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰
        playLoveSound();
    } else {
        surprise.classList.add('hidden');
        button.textContent = 'ç‚¹å‡»è¿™é‡Œ ğŸ’–';
    }
}

function createFloatingHearts() {
    const hearts = ['ğŸ’•', 'ğŸ’–', 'ğŸ’—', 'ğŸ’', 'ğŸ’˜', 'ğŸ’', 'ğŸ’“', 'ğŸ’Ÿ'];
    const container = document.querySelector('.floating-hearts');
    
    // åˆ›å»ºæ›´å¤šå¿ƒå½¢
    for (let i = 0; i < 10; i++) {
        const heart = document.createElement('div');
        heart.className = 'floating-heart';
        heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
        heart.style.left = Math.random() * 100 + '%';
        heart.style.animationDelay = Math.random() * 5 + 's';
        heart.style.animationDuration = (Math.random() * 3 + 5) + 's';
        container.appendChild(heart);
    }
}

function addClickEffects() {
    document.addEventListener('click', function(e) {
        // åˆ›å»ºç‚¹å‡»æ³¢çº¹æ•ˆæœ
        createRipple(e.clientX, e.clientY);
        
        // éšæœºåˆ›å»ºå¿ƒå½¢
        if (Math.random() < 0.3) {
            createClickHeart(e.clientX, e.clientY);
        }
    });
}

function createRipple(x, y) {
    const ripple = document.createElement('div');
    ripple.style.position = 'fixed';
    ripple.style.left = x + 'px';
    ripple.style.top = y + 'px';
    ripple.style.width = '10px';
    ripple.style.height = '10px';
    ripple.style.background = 'rgba(255, 107, 107, 0.6)';
    ripple.style.borderRadius = '50%';
    ripple.style.transform = 'translate(-50%, -50%)';
    ripple.style.animation = 'ripple 0.6s ease-out';
    ripple.style.pointerEvents = 'none';
    ripple.style.zIndex = '1000';
    
    document.body.appendChild(ripple);
    
    setTimeout(() => {
        ripple.remove();
    }, 600);
}

function createClickHeart(x, y) {
    const heart = document.createElement('div');
    heart.textContent = 'ğŸ’•';
    heart.style.position = 'fixed';
    heart.style.left = x + 'px';
    heart.style.top = y + 'px';
    heart.style.fontSize = '20px';
    heart.style.transform = 'translate(-50%, -50%)';
    heart.style.animation = 'heartFloat 2s ease-out forwards';
    heart.style.pointerEvents = 'none';
    heart.style.zIndex = '1000';
    
    document.body.appendChild(heart);
    
    setTimeout(() => {
        heart.remove();
    }, 2000);
}

function createExplosion() {
    const button = document.querySelector('.love-button');
    const rect = button.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + rect.height / 2;
    
    // åˆ›å»ºçˆ†ç‚¸å¿ƒå½¢
    for (let i = 0; i < 12; i++) {
        const heart = document.createElement('div');
        heart.textContent = 'ğŸ’•';
        heart.style.position = 'fixed';
        heart.style.left = centerX + 'px';
        heart.style.top = centerY + 'px';
        heart.style.fontSize = '24px';
        heart.style.transform = 'translate(-50%, -50%)';
        heart.style.animation = `explode 1s ease-out forwards`;
        heart.style.animationDelay = (i * 0.05) + 's';
        heart.style.pointerEvents = 'none';
        heart.style.zIndex = '1000';
        
        // éšæœºæ–¹å‘
        const angle = (i * 30) * Math.PI / 180;
        const distance = 100 + Math.random() * 50;
        const endX = centerX + Math.cos(angle) * distance;
        const endY = centerY + Math.sin(angle) * distance;
        
        heart.style.setProperty('--end-x', endX + 'px');
        heart.style.setProperty('--end-y', endY + 'px');
        
        document.body.appendChild(heart);
        
        setTimeout(() => {
            heart.remove();
        }, 1000);
    }
}

function addKeyboardInteractions() {
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            showSurprise();
        }
    });
}

function playLoveSound() {
    // è¿™é‡Œå¯ä»¥æ·»åŠ éŸ³æ•ˆï¼Œå¦‚æœéœ€è¦çš„è¯
    // ç”±äºæµè§ˆå™¨é™åˆ¶ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’åæ‰èƒ½æ’­æ”¾éŸ³é¢‘
    console.log('ğŸ’• çˆ±çš„å£°éŸ³ ğŸ’•');
}

// æ·»åŠ CSSåŠ¨ç”»æ ·å¼
const style = document.createElement('style');
style.textContent = `
    @keyframes ripple {
        0% {
            width: 10px;
            height: 10px;
            opacity: 1;
        }
        100% {
            width: 100px;
            height: 100px;
            opacity: 0;
        }
    }
    
    @keyframes heartFloat {
        0% {
            transform: translate(-50%, -50%) scale(0);
            opacity: 1;
        }
        50% {
            transform: translate(-50%, -70px) scale(1);
            opacity: 1;
        }
        100% {
            transform: translate(-50%, -100px) scale(0);
            opacity: 0;
        }
    }
    
    @keyframes explode {
        0% {
            transform: translate(-50%, -50%) scale(0);
            opacity: 1;
        }
        50% {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }
        100% {
            transform: translate(var(--end-x), var(--end-y)) scale(0);
            opacity: 0;
        }
    }
`;
document.head.appendChild(style);